#Delete some variables
breaches$X <- NULL
breaches$X.1 <- NULL
breaches$X.2 <- NULL
breaches$X.3 <- NULL
breaches$X.4 <- NULL
#Data Preparation
#Import Data
help(read.csv)
data1<-read.csv(file.choose(), header=T)
#To open the imported data
breaches
#Example, car_preference<-read.csv(file.choose(),header=T)
#Check Dimentionality
dim(breaches)
#Variable names or column names
names(breaches)
#Structure 
str(breaches)
#Attributes
attributes(breaches)
#Get the first 5 rows
breaches[2:5]
#Get "Location of Breach Information" of the first 10 rows
breaches[1:10, "Location_of_Breached_Information"]
#Different ways to get "Location of Breach Information" of the first 10 rows
breaches$Individuals_Affected[1:10]
#Distribution of every variable
summary(breaches)
#Frequency 
table(breaches$Type_of_Breach)
#Variance of "Type of Breach"
var(breaches$Type_of_Breach)
#Covariance of two variables
cov(breaches$Number, breaches$Individuals_Affected)
#Correlation of two variables
cor(breaches$Individuals_Affected, breaches$Number)


#Histogram
hist(breaches$Individuals_Affected)
#Density
plot(density(breaches$Individuals_Affected))
plot(density(breaches$Number))
#Scatter plot            
plot(breaches$Number, breaches$Individuals_Affected)
#Pair plot
plot(breaches)
head(breaches)
tail(breaches)
## draw a sample of 5 rows to retrieve sample randomly
idx <- sample(1:nrow(breaches), 5)
idx
#We can also retrieve the values of a single column. For example, the first 10 values of rdur can be done in 3 ways.

breaches[1:10, "Type_of_Breach"]
table(breaches$Individuals_Affected)
table(breaches$Type_of_Breach)
pie(table(breaches$Individuals_Affected))
pie(table(breaches$Type_of_Breach))
pie(table(breaches$Location_of_Breached_Information))
table(breaches$Location_of_Breached_Information)
summary(Breach_3)
quantile(breaches$Individuals_Affected)
barplot(table(breaches$Individuals_Affected))
barplot(table(breaches$Type_of_Breach))
barplot(table(breaches$Location_of_Breached_Information))
barplot(table(breaches$Number))
barplot(table(Car_Preference$rdur))
#Explore Multiple Variables
cov(breaches[,1:4])
cor(Car_Preference[,1:4])
#Aggregation of given variable by each column
aggregate(Individuals_Affected~ Type_of_Breach, summary, data=breaches)

boxplot(Individuals_Affected~ Type_of_Breach, data=breaches, xlab="Individuals_Affected", ylab="Type_of_Breach")
distMatrix <- as.matrix(dist(breaches[,1:4]))

#understand the missing value pattern
md.pattern(breaches)
is.na(breaches)
#sum and the percentage of missings in the dataset
sum(is.na(breaches))
# aggregate data frame 
# for numeric variables
attach(breaches)
aggdata <-aggregate(breaches, by=list(Individuals_Affected,Type_of_Breach), 
                    FUN=mean, na.rm=TRUE)
print(aggdata)
detach(breaches)


boxplot(Individuals_Affected~ Type_of_Breach, data=breaches, xlab="Location_of_Breached_Information", ylab="Number")
boxplot(ph~ gravity, data=Urine_Data, xlab="gravity", ylab="ph")
boxplot(ph~ gravity, data=Urine_Data, xlab="ph", ylab="gravity")
boxplot(ph~ gravity, data=Urine_Data, xlab="Cond", ylab="ph")
boxplot(ph~ gravity, data=Urine_Data, xlab="calc", ylab="ph")
boxplot(ph~ gravity, data=Urine_Data, xlab="urea", ylab="ph")




#Run regresion 
`breaches`
#Model Using all the variables
fn <- Individuals_Affected ~ Number + Type_of_Breach + Location_of_Breached_Information  
out <- lm(fn, data = breaches)
summary(out)
out
summary(out)
#Matrix with fn
mm <- model.matrix(fn,data = breaches)
data.frame(mm[,55],breaches$Individuals_Affected)
#Display specific Variable using level funtion
breaches$Type_of_Breach <- relevel(breaches$Type_of_Breach,"Theft")
levels(breaches$Type_of_Breach)
#Deicision tree modeling
#1st Grow tree by rpart(formula, data=, method=,control=) 
#Classification tree with rpart
install.packages("rpart")
library(rpart)
#grow tree
attach(breaches)
fit <- rpart(Type_of_Breach ~  Individuals_Affected + Location_of_Breached_Information,
             method="anova", data=Type_of_Breach)
summary(fit)
plot(fit)
text(fit)
#To make more pretty install some external package
install.packages('rattle')
install.packages('rpart.plot')
install.packages('RColorBrewer')
install.packages('fancyRpartPlot') 
library(rattle)
library(rpart.plot)
library(RColorBrewer)

install.packages('fancyRpartPlot')
fancyRpartPlot(fit)
RColorBrewer(fit)

s<- sample(150,100)
breach_train <- breaches[s,]
library(rpart)
#Create decision tree model
dtm<- rpart(Type_of_Breach~Number + Individuals_Affected + Location_of_Breached_Information  )
summary(breaches)
dtm<- rpart(Type_of_Breach~., breach_train, method = "class")

dtm
plot(dtm)
text(dtm)
library(rpart.plot)
library(rpart)
rpart.plot(dtm)
rpart.plot(dtm, type = 3, extra = 10)
text(dtm, pretty = 0)
#Prediction of decision tree
p<-predict(dtm, breach_train[,4], type="class")

table(breach_train[,4], p)
p<-predict(dtm, breach_train, type="class")
table(breach_train[,4], p)
